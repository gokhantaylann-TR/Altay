<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Altayâ€™Ä±n MacerasÄ±</title>

<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #87ceeb;
  overflow: hidden;
}

.ui {
  position: fixed;
  bottom: env(safe-area-inset-bottom, 10px);
  left: 0;
  right: 0;
  display: flex;
  justify-content: space-between;
  padding: 0 20px;
  pointer-events: none;
}

.ui button {
  pointer-events: auto;
  width: 64px;
  height: 64px;
  border-radius: 50%;
  border: none;
  font-size: 24px;
  background: rgba(0,0,0,0.55);
  color: #fff;
}
</style>
</head>

<body>

<div class="ui">
  <div>
    <button id="left">â—€</button>
    <button id="right">â–¶</button>
  </div>
  <button id="jump">â–²</button>
</div>

<script>
const config = {
  type: Phaser.AUTO,
  width: 800,
  height: 600,
  scale: {
    mode: Phaser.Scale.FIT,
    autoCenter: Phaser.Scale.CENTER_BOTH
  },
  physics: {
    default: 'arcade',
    arcade: { gravity: { y: 900 }, debug: false }
  },
  scene: { preload, create, update }
};

let player, cursors;
let moveLeft=false, moveRight=false, jump=false;
let enemies;

new Phaser.Game(config);

function preload() {
  this.load.image('ground','https://labs.phaser.io/assets/sprites/platform.png');
  this.load.spritesheet('altay','https://labs.phaser.io/assets/sprites/dude.png',{frameWidth:32,frameHeight:48});
  this.load.image('duck','https://labs.phaser.io/assets/sprites/duck.png');
  this.load.image('castle','https://labs.phaser.io/assets/sprites/castle.png');
}

function create() {
  this.physics.world.setBounds(0,0,1400,600);

  const platforms = this.physics.add.staticGroup();

  // ANA ZEMÄ°N
  for(let i=0;i<7;i++){
    platforms.create(200*i,580,'ground').setScale(2).refreshBody();
  }

  // PLATFORM DESENLERÄ° (tekli / ikili / Ã¼Ã§lÃ¼ / dÃ¶rtlÃ¼)
  platforms.create(300,420,'ground');
  platforms.create(450,350,'ground');
  platforms.create(520,350,'ground');

  platforms.create(700,300,'ground');
  platforms.create(780,300,'ground');
  platforms.create(860,300,'ground');

  platforms.create(1050,250,'ground');
  platforms.create(1120,250,'ground');
  platforms.create(1190,250,'ground');
  platforms.create(1260,250,'ground');

  // PLAYER
  player = this.physics.add.sprite(100,450,'altay');
  player.setCollideWorldBounds(true);

  this.anims.create({
    key:'left',
    frames:this.anims.generateFrameNumbers('altay',{start:0,end:3}),
    frameRate:10,
    repeat:-1
  });
  this.anims.create({
    key:'right',
    frames:this.anims.generateFrameNumbers('altay',{start:5,end:8}),
    frameRate:10,
    repeat:-1
  });
  this.anims.create({
    key:'idle',
    frames:[{key:'altay',frame:4}]
  });

  // ENEMY â€“ Ã–RDEK
  enemies = this.physics.add.group();
  const duck = enemies.create(720,260,'duck');
  duck.setScale(0.8);
  duck.setVelocityX(60);
  duck.minX = 680;
  duck.maxX = 880;

  // CASTLE
  const castle = this.physics.add.staticImage(1350,450,'castle').setScale(2.5);

  this.physics.add.collider(player, platforms);
  this.physics.add.collider(enemies, platforms);

  this.physics.add.overlap(player, enemies, hitEnemy, null, this);
  this.physics.add.overlap(player, castle, ()=>alert('ðŸ° BÃ¶lÃ¼m Tamam!'));

  this.cameras.main.setBounds(0,0,1400,600);
  this.cameras.main.startFollow(player,true,0.08,0.08);

  cursors = this.input.keyboard.createCursorKeys();

  // MOBÄ°L
  left.ontouchstart=()=>moveLeft=true;
  left.ontouchend=()=>moveLeft=false;
  right.ontouchstart=()=>moveRight=true;
  right.ontouchend=()=>moveRight=false;
  jumpBtn=jump;
  jump.ontouchstart=()=>jump=true;
}

function update() {
  if(cursors.left.isDown||moveLeft){
    player.setVelocityX(-200);
    player.anims.play('left',true);
  } else if(cursors.right.isDown||moveRight){
    player.setVelocityX(200);
    player.anims.play('right',true);
  } else {
    player.setVelocityX(0);
    player.anims.play('idle');
  }

  if((cursors.up.isDown||jump)&&player.body.touching.down){
    player.setVelocityY(-450);
    jump=false;
  }

  // ENEMY AI
  enemies.children.iterate(e=>{
    if(!e) return;
    if(e.x <= e.minX) e.setVelocityX(60);
    if(e.x >= e.maxX) e.setVelocityX(-60);
  });
}

function hitEnemy(player, enemy){
  if(player.body.velocity.y > 0){
    enemy.destroy();
    player.setVelocityY(-300);
  } else {
    this.scene.restart();
  }
}
</script>
</body>
</html>