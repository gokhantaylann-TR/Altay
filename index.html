<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Altay Macerası</title>
<link rel="manifest" href="./manifest.json">
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
<style>
    body { margin: 0; background: #000; overflow: hidden; touch-action: none; -webkit-user-select: none; user-select: none; -webkit-touch-callout: none; }
    canvas { display: block; margin: 0 auto; }
    .ui { position: fixed; bottom: 20px; left: 0; right: 0; display: flex; justify-content: space-between; padding: 0 30px; pointer-events: none; padding-bottom: env(safe-area-inset-bottom, 20px); }
    .btn { pointer-events: auto; width: 80px; height: 80px; border-radius: 50%; border: 4px solid rgba(255,255,255,0.5); background: rgba(0,0,0,0.3); color: #fff; font-size: 30px; display: flex; align-items: center; justify-content: center; }
    .btn:active { background: rgba(255,255,255,0.3); transform: scale(0.95); }
    .jump { background: rgba(255, 140, 0, 0.5); width: 90px; height: 90px; }
</style>
</head>
<body>
<div class="ui">
    <div><div id="L" class="btn">◀</div><div id="R" class="btn" style="margin-top:10px">▶</div></div>
    <div><div id="J" class="btn jump">▲</div></div>
</div>
<script>
const cfg = {
    type: Phaser.AUTO, width: 800, height: 600, backgroundColor: '#87ceeb',
    scale: { mode: Phaser.Scale.FIT, autoCenter: Phaser.Scale.CENTER_BOTH },
    physics: { default: 'arcade', arcade: { gravity: { y: 900 }, debug: false } },
    audio: { noAudio: true }, // IOS DONMASINI ENGELLEYEN KOD
    input: { activePointers: 3 },
    scene: { preload, create, update }
};
let p, c, m={l:0,r:0,j:0}; 
new Phaser.Game(cfg);

function preload() {
    this.load.image('s', 'https://labs.phaser.io/assets/skies/space3.png');
    this.load.image('g', 'https://labs.phaser.io/assets/sprites/platform.png');
    this.load.spritesheet('d', 'https://labs.phaser.io/assets/sprites/dude.png', { frameWidth: 32, frameHeight: 48 });
}
function create() {
    this.add.tileSprite(400, 300, 800, 600, 's');
    let pl = this.physics.add.staticGroup();
    pl.create(400, 568, 'g').setScale(2).refreshBody();
    pl.create(600, 400, 'g'); pl.create(50, 250, 'g'); pl.create(750, 220, 'g');
    p = this.physics.add.sprite(100, 450, 'd').setBounce(0.1).setCollideWorldBounds(true);
    this.anims.create({ key: 'l', frames: this.anims.generateFrameNumbers('d', { start:0, end:3 }), frameRate: 10, repeat:-1 });
    this.anims.create({ key: 't', frames: [{ key:'d', frame:4 }], frameRate: 20 });
    this.anims.create({ key: 'r', frames: this.anims.generateFrameNumbers('d', { start:5, end:8 }), frameRate: 10, repeat:-1 });
    this.physics.add.collider(p, pl);
    c = this.input.keyboard.createCursorKeys();
    const b = (id,k) => { 
        let e=document.getElementById(id); 
        e.addEventListener('touchstart',x=>{x.preventDefault();m[k]=1},{passive:false}); 
        e.addEventListener('touchend',x=>{x.preventDefault();m[k]=0}); 
        e.addEventListener('mousedown',()=>m[k]=1); e.addEventListener('mouseup',()=>m[k]=0); 
    };
    b('L','l'); b('R','r'); b('J','j');
}
function update() {
    if (c.left.isDown || m.l) { p.setVelocityX(-160); p.anims.play('l', true); }
    else if (c.right.isDown || m.r) { p.setVelocityX(160); p.anims.play('r', true); }
    else { p.setVelocityX(0); p.anims.play('t'); }
    if ((c.up.isDown || m.j) && p.body.touching.down) { p.setVelocityY(-550); m.j=0; }
}
if('serviceWorker' in navigator){window.addEventListener('load',()=>navigator.serviceWorker.register('./sw.js'));}
</script></body></html>
